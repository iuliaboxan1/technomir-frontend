<!-- http.HandleFunc("/account", func(w http.ResponseWriter, r *http.Request) {

cookie, err := r.Cookie("access_token")
if err != nil || cookie.Value == "" {
http.Redirect(w, r, "/login", http.StatusSeeOther)
return
}

token := cookie.Value

email, err := extractEmailFromJWT(token)
if err != nil {
http.Redirect(w, r, "/login", http.StatusSeeOther)
return
}

// Fetch orders
ordersData, _, err := supabaseClient.
From("orders").
Select("*", "", false).
Eq("user_id", userID).
Order("created_at", "desc").
Execute()

if err != nil {
http.Error(w, "Failed to load orders: "+err.Error(), 500)
return
}

var orders []map[string]interface{}
if err := json.Unmarshal(ordersData, &orders); err != nil {
http.Error(w, "Failed to decode orders JSON: "+err.Error(), 500)
return
}


accountTpl.Execute(w, map[string]interface{}{
"Email": email,
"Cart": cart,
"Total": total,
"Orders": orders,
})
}) -->